{
    "transforms": [
        {
            "type": "kafka_input",
            "data-type": "csv",
            "topic": "rdw",
            "columns": [
                {
                    "name": "kenteken",
                    "type": "STRING",
                    "index": 0
                },
                {
                    "name": "merk",
                    "type": "STRING",
                    "index": 2
                },
                {
                    "name": "kleur",
                    "type": "STRING",
                    "index": 10
                },
                {
                    "name": "datum_afgifte",
                    "type": "dateyyyyMMdd",
                    "index": 21
                }
            ]
        },
        {
            "type": "SQL_transform",
            "query": "SELECT merk, count(kenteken) AS aantal, min(datum_afgifte) AS eerste_datum FROM PCOLLECTION WHERE YEAR(datum_afgifte) = 2017 GROUP BY merk"
        },
        {
            "type": "SQL_transform",
            "query": "SELECT kleur, count(kenteken) AS aantal FROM PCOLLECTION GROUP BY kleur"
        },
        {
            "type": "kafka_output",
            "topic": "res1"
        },
        {
            "type": "kafka_output",
            "topic": "res2"
        }
    ],
    "DAG-mapping": [[0,1],[0,2],[1,3],[2,4]]
}
